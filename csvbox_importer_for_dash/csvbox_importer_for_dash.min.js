(()=>{"use strict";var t,e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},n=function(){var t=document.currentScript;if(!t){for(var e=document.getElementsByTagName("script"),n=[],o=0;o<e.length;o++)n.push(e[o]);t=(n=n.filter((function(t){return!t.async&&!t.text&&!t.textContent}))).slice(-1)[0]}return t};if(Object.defineProperty(e,"p",{get:(t=n().src.split("/").slice(0,-1).join("/")+"/",function(){return t})}),"undefined"!=typeof jsonpScriptSrc){var o=jsonpScriptSrc;jsonpScriptSrc=function(t){var e,r=(e=n(),/\/_dash-component-suites\//.test(e.src)),i=o(t);if(!r)return i;var a=i.split("/"),s=a.slice(-1)[0].split(".");return s.splice(1,0,"v0_0_1m1690558204"),a.splice(-1,1,s.join(".")),a.join("/")}}var r={};e.r(r),e.d(r,{CsvboxImporterForDash:()=>y});const i=window.React;var a=e.n(i);const s=window.PropTypes;var l=e.n(s);function d(t,e){return d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},d(t,e)}var u=function(t){var e,n;function o(e){var n;return(n=t.call(this,e)||this).holder=a().createRef(),n.openModal=n.openModal.bind(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(n)),n.isModalShown=!1,n.shouldOpenModalOnReady=!1,n.uuid=n.generateUuid(),n.state={isLoading:!0},n.iframe=null,n}n=t,(e=o).prototype=Object.create(n.prototype),e.prototype.constructor=e,d(e,n);var r=o.prototype;return r.componentDidMount=function(){var t=this.props.lazy;t||this.iframe?t&&this.enableInitator():this.initImporter()},r.initImporter=function(){var t=this,e=this.props.loadStarted;null==e||e();var n=this.props.user,o=this.props.dynamicColumns,r=this.props.options,i=this.props.onReady,a=this.props.onImport,s=this.props.onSubmit,l=this.props.onClose,d=this.props.licenseKey,u=this.props.dataLocation,p=this.props.customDomain,c=this.props.language,f=p||"app.csvbox.io";u&&(f=u+"-"+f);var h="https://"+f+"/embed/"+d;h+="?library-version=1.1.8",h+="&framework=react",u&&(h+="&preventRedirect"),c&&(h+="&language="+c),window.addEventListener("message",(function(e){var n,o;if("mainModalHidden"===e.data&&(t.holder&&t.holder.current&&(t.holder.current.style.display="none"),t.isModalShown=!1,null==l||l()),"uploadSuccessful"===e.data&&a(!0),"uploadFailed"===e.data&&a(!1),"object"==typeof e.data&&(null==e||null===(n=e.data)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.unique_token)==t.uuid)if(e.data.type&&"data-on-submit"==e.data.type){var r=e.data.data;r.column_mappings=e.data.column_mapping,delete r.unique_token,null==s||s(r)}else if(e.data.type&&"data-push-status"==e.data.type)if("success"==e.data.data.import_status)if(e.data&&e.data.row_data){var i=e.data.row_data,d=e.data.headers,u=[],p=e.data.dynamicColumnsIndexes,c=e.data.virtualColumnsIndexes||[],f=e.data.dropdown_display_labels_mappings;i.forEach((function(t){var e={},n={},o={};t.data.forEach((function(t,r){null==t&&(t=""),f[r]&&f[r][t]&&(t=f[r][t]),p.includes(r)?n[d[r]]=t:c.includes(r)?o[d[r]]=t:e[d[r]]=t})),t.unmapped_data&&(e._unmapped_data=t.unmapped_data),n&&Object.keys(n).length>0&&(e._dynamic_data=n),o&&Object.keys(o).length>0&&(e._virtual_data=o),u.push(e)}));var h=e.data.data;h.rows=u,h.column_mappings=e.data.column_mapping,h.raw_columns=e.data.raw_columns,h.ignored_columns=e.data.ignored_column_row,delete h.unique_token,a(!0,h)}else{var y=e.data.data;delete y.unique_token,a(!0,y)}else a(!1,e.data.data);else if(e.data.type&&"csvbox-modal-hidden"==e.data.type)t.holder&&t.holder.current&&(t.holder.current.style.display="none"),t.isModalShown=!1,null==l||l();else if(e.data.type&&"csvbox-upload-successful"==e.data.type){var m;null===(m=t.onImport)||void 0===m||m.call(t,!0)}else if(e.data.type&&"csvbox-upload-failed"==e.data.type){var v;null===(v=t.onImport)||void 0===v||v.call(t,!1)}}),!1);var y=this,m=document.createElement("iframe");this.iframe=m,m.setAttribute("src",h),m.frameBorder=0,m.classList.add("csvbox-iframe"),m.style.height="100%",m.style.width="100%",m.style.position="absolute",m.style.top="0px",m.style.left="0px",window.addEventListener("message",this.onMessageEvent,!1),m.onload=function(){y.enableInitator(),m.contentWindow.postMessage({customer:n||null,columns:o||null,options:r||null,unique_token:y.uuid},"*"),null==i||i(),y.shouldOpenModalOnReady&&(y.openModal(),y.shouldOpenModalOnReady=!1)},this.holder.current.appendChild(m)},r.openModal=function(){if(this.props.lazy&&!this.iframe)return this.shouldOpenModalOnReady=!0,void this.initImporter();this.isModalShown||(this.state.isLoading?this.shouldOpenModalOnReady=!0:(this.isModalShown=!0,this.iframe.contentWindow.postMessage("openModal","*"),this.holder.current.style.display="block"))},r.generateUuid=function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},r.enableInitator=function(){this.setState({isLoading:!1})},r.render=function(){var t={display:"none",zIndex:2147483647,position:"fixed",top:0,bottom:0,left:0,right:0};return this.props.render?a().createElement("div",null,this.props.render(this.openModal,this.state.isLoading),a().createElement("div",{ref:this.holder,style:t})):a().createElement("div",null,a().createElement("button",{disabled:this.state.isLoading,onClick:this.openModal,"data-csvbox-initator":!0,"data-csvbox-token":this.uuid},this.props.children),a().createElement("div",{ref:this.holder,style:t}))},o}(i.Component);function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==p(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==p(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===p(r)?r:String(r)),o)}var r}function f(t,e){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},f(t,e)}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(s,t);var e,n,o,r,i=(o=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h(o);if(r){var n=h(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===p(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),i.apply(this,arguments)}return e=s,(n=[{key:"render",value:function(){var t=this.props,e=t.id,n=t.licenseKey,o=t.userId,r=t.setProps;return a().createElement(u,{id:e,licenseKey:n,user:{user_id:o},onImport:function(t,e){r&&r({result:t,data:e})},render:function(t,e){return a().createElement("button",{disabled:e,onClick:t},"Upload file")}},"Import")}}])&&c(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(i.Component);y.defaultProps={},y.propTypes={id:l().string,licenseKey:l().string.isRequired,userId:l().string.isRequired,setProps:l().func,result:l().bool,data:l().object},window.csvbox_importer_for_dash=r})();
//# sourceMappingURL=csvbox_importer_for_dash.min.js.map